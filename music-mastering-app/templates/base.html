<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Plataforma para Produtores Musicais{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
</head>
<body>
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}" style="opacity: 0; transform: translateX(100%); animation: slideInRight 0.3s ease forwards;">
                        <i class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'error' %}exclamation-circle{% else %}info-circle{% endif %}"></i>
                        <span>{{ message }}</span>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <nav class="navbar">
        <div class="navbar-container">
            <a href="{{ url_for('home') }}" class="navbar-brand">
                <i class="fas fa-music"></i> SoundNest
            </a>
            
            <button class="menu-toggle" type="button" aria-label="Abrir menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <ul class="navbar-nav">
                <li><a href="{{ url_for('home') }}" class="nav-link">Home</a></li>
                <li><a href="{{ url_for('tutoriais') }}" class="nav-link">Tutoriais</a></li>
                {% if current_user.is_authenticated %}
                    <li><a href="{{ url_for('servicos') }}" class="nav-link">Serviços</a></li>
                    <li><a href="{{ url_for('masterizacao') }}" class="nav-link">Masterização</a></li>
                    <li class="user-menu">
                        <div class="user-dropdown">
                            <button class="user-dropdown-toggle">
                                <i class="fas fa-user-circle"></i>
                                <span class="user-name">{{ current_user.nome if current_user and current_user.nome else 'Usuário' }}</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="user-dropdown-menu">
                                <a href="{{ url_for('dashboard') }}" class="dropdown-item">
                                    <i class="fas fa-tachometer-alt"></i> Dashboard
                                </a>
                                <a href="{{ url_for('logout') }}" class="dropdown-item">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </a>
                            </div>
                        </div>
                    </li>
                {% else %}
                    <li><a href="{{ url_for('login') }}" class="btn btn-secondary">Login</a></li>
                    <li><a href="{{ url_for('cadastro') }}" class="btn btn-primary">Cadastro</a></li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3><i class="fas fa-music"></i> SoundNest</h3>
                <p>Sua plataforma completa para produção musical profissional. Tutoriais, serviços de ghost producer e masterização de qualidade.</p>
            </div>
            
            <div class="footer-section">
                <h3>Serviços</h3>
                <p><a href="{{ url_for('tutoriais') }}">Tutoriais</a></p>
                <p><a href="{{ url_for('servicos') }}">Ghost Producer</a></p>
                <p><a href="{{ url_for('masterizacao') }}">Masterização</a></p>
            </div>
            
            <div class="footer-section">
                <h3>Contato</h3>
                <p><i class="fas fa-envelope"></i> contato@soundnest.com</p>
                <p><i class="fas fa-phone"></i> +55 (11) 99999-9999</p>
                <p><i class="fab fa-whatsapp"></i> WhatsApp</p>
            </div>
            
            <div class="footer-section">
                <h3>Redes Sociais</h3>
                <p><a href="#"><i class="fab fa-instagram"></i> Instagram</a></p>
                <p><a href="#"><i class="fab fa-youtube"></i> YouTube</a></p>
                <p><a href="#"><i class="fab fa-facebook"></i> Facebook</a></p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 SoundNest. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        function closeToast(toastElement) {
            toastElement.style.opacity = '0';
            toastElement.style.transform = 'translateX(100%)';
            setTimeout(function(){ 
                if (toastElement.parentNode) {
                    toastElement.remove(); 
                }
            }, 300);
        }

        document.addEventListener('DOMContentLoaded', function() {
            const flashMessages = document.querySelectorAll('.flash-message');
            flashMessages.forEach(function(message) {
                message.style.cursor = 'pointer';
                message.addEventListener('click', function() {
                    closeToast(message);
                });
                setTimeout(function() {
                    closeToast(message);
                }, 4000);
            });
        });

        window.showToast = function(type, message) {
            const container = document.querySelector('.flash-messages') || (function(){
                const c = document.createElement('div');
                c.className = 'flash-messages';
                document.body.appendChild(c);
                return c;
            })();
            const el = document.createElement('div');
            el.className = 'flash-message ' + (type || 'info');
            el.style.cursor = 'pointer';
            
            const icons = {
                'success': 'fa-check-circle',
                'error': 'fa-exclamation-circle',
                'info': 'fa-info-circle'
            };
            
            const icon = document.createElement('i');
            icon.className = 'fas ' + (icons[type] || icons['info']);
            el.appendChild(icon);
            
            const text = document.createElement('span');
            text.textContent = message || '';
            el.appendChild(text);
            
            container.appendChild(el);
            
            el.addEventListener('click', function() {
                closeToast(el);
            });
            
            const autoCloseTimeout = setTimeout(function() {
                closeToast(el);
            }, 4000);
            
            el.addEventListener('mouseenter', function() {
                clearTimeout(autoCloseTimeout);
            });
            
            el.addEventListener('mouseleave', function() {
                setTimeout(function() {
                    closeToast(el);
                }, 4000);
            });
        }
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        const currentLocation = window.location.pathname;
        document.querySelectorAll('.nav-link').forEach(link => {
            if (link.getAttribute('href') === currentLocation) {
                link.classList.add('active');
            }
        });
        const menuToggle = document.querySelector('.menu-toggle');
        const navbarNav = document.querySelector('.navbar-nav');
        
        if (menuToggle && navbarNav) {
            menuToggle.addEventListener('click', function() {
                navbarNav.classList.toggle('active');
            });
            document.addEventListener('click', function(e) {
                if (!menuToggle.contains(e.target) && !navbarNav.contains(e.target)) {
                    navbarNav.classList.remove('active');
                }
            });
        }
        const userDropdownToggle = document.querySelector('.user-dropdown-toggle');
        const userDropdownMenu = document.querySelector('.user-dropdown-menu');
        
        if (userDropdownToggle && userDropdownMenu) {
            userDropdownToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                userDropdownMenu.classList.toggle('active');
            });
            document.addEventListener('click', function() {
                userDropdownMenu.classList.remove('active');
            });
            userDropdownMenu.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
    </script>
</body>
</html>
